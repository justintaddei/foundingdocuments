function _templateObject3(){var e=_taggedTemplateLiteral(["\n      <p>","</p>\n    "]);return _templateObject3=function(){return e},e}function _templateObject2(){var e=_taggedTemplateLiteral(['\n      <button\n        class="if-nav-hidden not-when-searching if-bookmarks-not-open"\n        id="toggleNav"\n        title="Menu"\n      >\n        <svg\n          class="if-nav-not-open"\n          xmlns="http://www.w3.org/2000/svg"\n          viewBox="0 0 24 24"\n        >\n          <path fill="none" d="M0 0h24v24H0V0z" />\n          <path\n            fill="currentColor"\n            d="M4 18h16c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1s.45 1 1 1zm0-5h16c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1s.45 1 1 1zM3 7c0 .55.45 1 1 1h16c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1z"\n          />\n        </svg>\n        <svg\n          class="if-nav-open"\n          xmlns="http://www.w3.org/2000/svg"\n          viewBox="0 0 24 24"\n        >\n          <path fill="none" d="M0 0h24v24H0V0z" />\n          <path\n            fill="currentColor"\n            d="M18.3 5.71c-.39-.39-1.02-.39-1.41 0L12 10.59 7.11 5.7c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41L10.59 12 5.7 16.89c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0L12 13.41l4.89 4.89c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4z"\n          />\n        </svg>\n      </button>\n      <button\n        class="if-nav-not-open if-selection"\n        id="saveBookmark"\n        title="Bookmark"\n      >\n        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">\n          <path fill="none" d="M0 0h24v24H0V0z" />\n          <path\n            fill="currentColor"\n            d="M19.65 9.04l-4.84-.42-1.89-4.45c-.34-.81-1.5-.81-1.84 0L9.19 8.63l-4.83.41c-.88.07-1.24 1.17-.57 1.75l3.67 3.18-1.1 4.72c-.2.86.73 1.54 1.49 1.08l4.15-2.5 4.15 2.51c.76.46 1.69-.22 1.49-1.08l-1.1-4.73 3.67-3.18c.67-.58.32-1.68-.56-1.75zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"\n          />\n        </svg>\n      </button>\n      <button\n        class="not-when-searching if-bookmarks"\n        id="toggleBookmarks"\n        title="Toggle bookmarks"\n      >\n        <svg\n          class="if-bookmarks-not-visible if-nav-not-open"\n          xmlns="http://www.w3.org/2000/svg"\n          viewBox="0 0 24 24"\n        >\n          <path fill="none" d="M0 0h24v24H0V0z" />\n          <path\n            fill="currentColor"\n            d="M17 3H7c-1.1 0-2 .9-2 2v16l7-3 7 3V5c0-1.1-.9-2-2-2z"\n          />\n        </svg>\n        <svg\n          class="if-bookmarks-visible if-nav-not-open"\n          xmlns="http://www.w3.org/2000/svg"\n          viewBox="0 0 24 24"\n        >\n          <path fill="none" d="M0 0h24v24H0V0z" />\n          <path\n            fill="currentColor"\n            d="M17 3H7c-1.1 0-2 .9-2 2v16l7-3 7 3V5c0-1.1-.9-2-2-2zm0 15l-5-2.18L7 18V6c0-.55.45-1 1-1h8c.55 0 1 .45 1 1v12z"\n          />\n        </svg>\n      </button>\n\n      <button\n        class="if-nav-not-open not-when-searching"\n        id="viewBookmarks"\n        title="Bookmark"\n      >\n        <svg\n          class="if-bookmarks-not-open"\n          xmlns="http://www.w3.org/2000/svg"\n          viewBox="0 0 24 24"\n        >\n          <path fill="none" d="M0 0h24v24H0V0z" />\n          <path\n            fill="currentColor"\n            d="M18 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 4h5v8l-2.5-1.5L6 12V4z"\n          />\n        </svg>\n\n        <svg\n          class="if-bookmarks-open"\n          xmlns="http://www.w3.org/2000/svg"\n          viewBox="0 0 24 24"\n        >\n          <path fill="none" d="M0 0h24v24H0z" />\n          <path\n            fill="currentColor"\n            d="M17.5 4.5c-1.95 0-4.05.4-5.5 1.5-1.45-1.1-3.55-1.5-5.5-1.5-1.45 0-2.99.22-4.28.79C1.49 5.62 1 6.33 1 7.14v11.28c0 1.3 1.22 2.26 2.48 1.94.98-.25 2.02-.36 3.02-.36 1.56 0 3.22.26 4.56.92.6.3 1.28.3 1.87 0 1.34-.67 3-.92 4.56-.92 1 0 2.04.11 3.02.36 1.26.33 2.48-.63 2.48-1.94V7.14c0-.81-.49-1.52-1.22-1.85-1.28-.57-2.82-.79-4.27-.79zM21 17.23c0 .63-.58 1.09-1.2.98-.75-.14-1.53-.2-2.3-.2-1.7 0-4.15.65-5.5 1.5V8c1.35-.85 3.8-1.5 5.5-1.5.92 0 1.83.09 2.7.28.46.1.8.51.8.98v9.47z"\n          />\n        </svg>\n      </button>\n\n      <div class="search-container">\n        <input type="text" placeholder="Search..." />\n        <div class="search-controls">\n          <button id="searchBackward">\n            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">\n              <path fill="none" d="M0 0h24v24H0V0z" />\n              <path\n                fill="currentColor"\n                d="M14.71 6.71c-.39-.39-1.02-.39-1.41 0L8.71 11.3c-.39.39-.39 1.02 0 1.41l4.59 4.59c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L10.83 12l3.88-3.88c.39-.39.38-1.03 0-1.41z"\n              />\n            </svg>\n          </button>\n          <div class="count">\n            <span id="searchCurrentNumber">0</span>\n            /\n            <span id="searchTotalNumber">0</span>\n          </div>\n\n          <button id="searchForward">\n            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">\n              <path fill="none" d="M0 0h24v24H0V0z" />\n              <path\n                fill="currentColor"\n                d="M9.29 6.71c-.39.39-.39 1.02 0 1.41L13.17 12l-3.88 3.88c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0l4.59-4.59c.39-.39.39-1.02 0-1.41L10.7 6.7c-.38-.38-1.02-.38-1.41.01z"\n              />\n            </svg>\n          </button>\n        </div>\n      </div>\n      <button class="if-nav-not-open" title="Search">\n        <svg\n          class="not-when-searching"\n          xmlns="http://www.w3.org/2000/svg"\n          viewBox="0 0 24 24"\n        >\n          <path fill="none" d="M0 0h24v24H0V0z" />\n          <path\n            fill="currentColor"\n            d="M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"\n          />\n        </svg>\n\n        <svg\n          class="when-searching"\n          xmlns="http://www.w3.org/2000/svg"\n          viewBox="0 0 24 24"\n        >\n          <path fill="none" d="M0 0h24v24H0V0z" />\n          <path\n            fill="currentColor"\n            d="M18.3 5.71c-.39-.39-1.02-.39-1.41 0L12 10.59 7.11 5.7c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41L10.59 12 5.7 16.89c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0L12 13.41l4.89 4.89c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4z"\n          />\n        </svg>\n      </button>\n    ']);return _templateObject2=function(){return e},e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function _typeof2(e){return(_typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function asyncGeneratorStep(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function _asyncToGenerator(s){return function(){var e=this,a=arguments;return new Promise(function(t,n){var r=s.apply(e,a);function o(e){asyncGeneratorStep(r,t,n,o,i,"next",e)}function i(e){asyncGeneratorStep(r,t,n,o,i,"throw",e)}o(void 0)})}}function _templateObject(){var e=_taggedTemplateLiteral(["\n      <span>","</span>\n      <button>","</button>\n    "]);return _templateObject=function(){return e},e}function _taggedTemplateLiteral(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof2(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _wrapNativeSuper(e){var n="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(t,e)})(e)}function isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function _construct(e,t,n){return(_construct=isNativeReflectConstruct()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&_setPrototypeOf(o,n.prototype),o}).apply(null,arguments)}function _isNativeFunction(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(){"use strict";"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function e(e,t){return e(t={exports:{}},t.exports),t.exports}var t,o,r,i,n=e(function(e,t){"undefined"!=typeof window&&window,e.exports=function(a){a=a||{};var s={},c=Array.prototype.slice;return Object.defineProperties(a,{on:{value:function(e,t){return"function"==typeof t&&(s[e]=s[e]||[]).push(t),a},enumerable:!1,writable:!1,configurable:!1},off:{value:function(e,t){if("*"!=e||t)if(t)for(var n,r=s[e],o=0;n=r&&r[o];++o)n==t&&r.splice(o--,1);else delete s[e];else s={};return a},enumerable:!1,writable:!1,configurable:!1},one:{value:function(t,n){return a.on(t,function e(){a.off(t,e),n.apply(a,arguments)})},enumerable:!1,writable:!1,configurable:!1},trigger:{value:function(e){var t,n,r,o=arguments.length-1,i=new Array(o);for(r=0;r<o;r++)i[r]=arguments[r+1];for(t=c.call(s[e]||[],0),r=0;n=t[r];++r)n.apply(a,i);return s["*"]&&"*"!=e&&a.trigger.apply(a,["*",e].concat(i)),a},enumerable:!1,writable:!1,configurable:!1}}),a}}),a=/^.+?\/\/+[^/]+/,s="EventListener",c="remove"+s,l="add"+s,u="hasAttribute",h="popstate",f="hashchange",d="trigger",p=3,v="undefined"!=typeof window&&window,m="undefined"!=typeof document&&document,g=v&&history,y=v&&(g.location||v.location),k=L.prototype,b=m&&m.ontouchstart?"touchstart":"click",w=n(),S=!1,x=!1,E=[],_=0;function C(e){return e.split(/[/?#]/)}function T(e,t){var n=t.replace(/\?/g,"\\?").replace(/\*/g,"([^/?#]+?)").replace(/\.\./,".*"),r=new RegExp("^"+n+"$"),o=e.match(r);if(o)return o.slice(1)}function N(e){t=function(e,t){var n;return function(){clearTimeout(n),n=setTimeout(e,t)}}(A,1),v[l](h,t),v[l](f,t),m[l](b,F),e&&A(!0)}function L(){this.$=[],n(this),w.on("stop",this.s.bind(this)),w.on("emit",this.e.bind(this))}function O(e){return e.replace(/^\/|\/$/,"")}function I(e){return"string"==typeof e}function R(e){return(e||y.href).replace(a,"")}function M(e){var t=z._.base;return"#"===t[0]?(e||y.href||"").split(t)[1]||"":(y?R(e):e||"").replace(t,"")}function A(t){var e=0===_;if(!(p<=_)&&(_++,E.push(function(){var e=M();!t&&e===o||(w[d]("emit",e),o=e)}),e)){for(var n;n=E.shift();)n();_=0}}function F(e){if(!(1!==e.which||e.metaKey||e.ctrlKey||e.shiftKey||e.defaultPrevented)){for(var t=e.target;t&&"A"!==t.nodeName;)t=t.parentNode;if(t&&"A"===t.nodeName&&!t[u]("download")&&t[u]("href")&&(!t.target||"_self"===t.target)&&-1!==t.href.indexOf(y.href.match(a)[0])){var n=z._.base;t.href!==y.href&&(t.href.split("#")[0]===y.href.split("#")[0]||"#"!==n[0]&&0!==R(t.href).indexOf(n)||"#"===n[0]&&t.href.split(n)[0]!==y.href.split(n)[0]||!B(M(t.href),t.title||m.title))||e.preventDefault()}}}function B(e,t,n){return g?(e=z._.base+O(e),t=t||m.title,n?g.replaceState(null,t,e):g.pushState(null,t,e),m.title=t,x=!1,A(),x):w[d]("emit",M(e))}k.m=function(e,t,n){!I(e)||t&&!I(t)?t?this.r(e,t):this.r("@",e):B(e,t,n||!1)},k.s=function(){this.off("*"),this.$=[]},k.e=function(n){this.$.concat("@").some(function(e){var t=("@"===e?r:i)(O(n),O(e));if(void 0!==t)return this[d].apply(null,[e].concat(t)),x=!0},this)},k.r=function(e,t){"@"!==e&&(e="/"+O(e),this.$.push(e)),this.on(e,t)};var P=new L,z=P.m.bind(P);function H(e){if(e){var t=e.getBoundingClientRect().top+window.pageYOffset;window.scrollTo({top:t-200,behavior:"smooth"})}}function j(e,t,n){return new W(e,t,n)}z._={base:null,getPathFromBase:M},z.create=function(){var e=new L,t=e.m.bind(e);return t.stop=e.s.bind(e),t},z.base=function(e){z._.base=e||"#",o=M()},z.exec=function(){A(!0)},z.parser=function(e,t){e||t||(r=C,i=T),e&&(r=e),t&&(i=t)},z.query=function(){var r={};return(y.href||o).replace(/[?&](.+?)=([^&]*)/g,function(e,t,n){r[t]=n}),r},z.stop=function(){S&&(v&&(v[c](h,t),v[c](f,t),m[c](b,F)),w[d]("stop"),S=!1)},z.start=function(e){S||(v&&("interactive"===document.readyState||"complete"===document.readyState?N(e):document.onreadystatechange=function(){"interactive"===document.readyState&&setTimeout(function(){N(e)},1)}),S=!0)},z.base(),z.parser();var q=String.raw,W=function(e){function i(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{label:"Close"},r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1e4;_classCallCheck(this,i),(t=_possibleConstructorReturn(this,_getPrototypeOf(i).call(this))).action=n&&"function"==typeof n.action?n.action:function(){},t.innerHTML=q(_templateObject(),e,n.label);var o=document.querySelector("#toastContainer");return o&&o.appendChild(_assertThisInitialized(t)),t._delay=r,t.setTimeout(),t.querySelector("button").addEventListener("click",function(){t.remove(),t.action(),t.clearTimeout()}),t}function t(){return n.apply(this,arguments)}var n,r;function o(){return r.apply(this,arguments)}return _inherits(i,_wrapNativeSuper(HTMLElement)),_createClass(i,[{key:"setTimeout",value:(r=function(){this._timeout=setTimeout(this.remove.bind(this),this._delay)},o.toString=function(){return r.toString()},o)},{key:"clearTimeout",value:(n=function(){clearTimeout(this._timeout)},t.toString=function(){return n.toString()},t)}]),i}();customElements.get("us-toast")||customElements.define("us-toast",W);new IntersectionObserver(function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;a.isIntersecting&&a.target}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}},{rootMargin:"0px 0px -90% 0px",threshold:1});document.addEventListener("beforeunload",function(){localStorage.setItem("lastRead",window.pageYOffset)}),document.addEventListener("pointerup",function(){localStorage.setItem("lastRead",window.pageYOffset)}),document.addEventListener("blur",function(){localStorage.setItem("lastRead",window.pageYOffset)});var J=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))}var n;return _inherits(t,_wrapNativeSuper(HTMLElement)),_createClass(t,[{key:"connectedCallback",value:function(){this.continueWhereLastRead()}},{key:"continueWhereLastRead",value:(n=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=localStorage.getItem("lastRead")){e.next=3;break}return e.abrupt("return");case 3:j("Continue where you left off?",{label:"Go",action:function(){window.scrollTo({top:parseFloat(t,10),behavior:"smooth"})}});case 4:case"end":return e.stop()}},e)})),function(){return n.apply(this,arguments)})}]),t}();customElements.get("us-constitution")||customElements.define("us-constitution",J);var V=e(function(e,t){var r,o,i,a,s,c;e.exports=(r="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return _typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e)},o=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},i=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function l(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:5e3;o(this,l),this.ctx=e,this.iframes=t,this.exclude=n,this.iframesTimeout=r}return i(l,[{key:"getContexts",value:function(){var n=[];return(void 0!==this.ctx&&this.ctx?NodeList.prototype.isPrototypeOf(this.ctx)?Array.prototype.slice.call(this.ctx):Array.isArray(this.ctx)?this.ctx:"string"==typeof this.ctx?Array.prototype.slice.call(document.querySelectorAll(this.ctx)):[this.ctx]:[]).forEach(function(t){var e=0<n.filter(function(e){return e.contains(t)}).length;-1!==n.indexOf(t)||e||n.push(t)}),n}},{key:"getIframeContents",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){},r=void 0;try{var o=e.contentWindow;if(r=o.document,!o||!r)throw new Error("iframe inaccessible")}catch(e){n()}r&&t(r)}},{key:"isIframeBlank",value:function(e){var t="about:blank",n=e.getAttribute("src").trim(),r=e.contentWindow.location.href;return r===t&&n!==t&&n}},{key:"observeIframeLoad",value:function(t,n,r){var o=this,i=!1,a=null,e=function e(){if(!i){i=!0,clearTimeout(a);try{o.isIframeBlank(t)||(t.removeEventListener("load",e),o.getIframeContents(t,n,r))}catch(e){r()}}};t.addEventListener("load",e),a=setTimeout(e,this.iframesTimeout)}},{key:"onIframeReady",value:function(e,t,n){try{"complete"===e.contentWindow.document.readyState?this.isIframeBlank(e)?this.observeIframeLoad(e,t,n):this.getIframeContents(e,t,n):this.observeIframeLoad(e,t,n)}catch(e){n()}}},{key:"waitForIframes",value:function(e,t){var n=this,r=0;this.forEachIframe(e,function(){return!0},function(e){r++,n.waitForIframes(e.querySelector("html"),function(){--r||t()})},function(e){e||t()})}},{key:"forEachIframe",value:function(e,n,r){var o=this,t=3<arguments.length&&void 0!==arguments[3]?arguments[3]:function(){},i=e.querySelectorAll("iframe"),a=i.length,s=0;i=Array.prototype.slice.call(i);var c=function(){--a<=0&&t(s)};a||c(),i.forEach(function(t){l.matches(t,o.exclude)?c():o.onIframeReady(t,function(e){n(t)&&(s++,r(e)),c()},c)})}},{key:"createIterator",value:function(e,t,n){return document.createNodeIterator(e,t,n,!1)}},{key:"createInstanceOnIframe",value:function(e){return new l(e.querySelector("html"),this.iframes)}},{key:"compareNodeIframe",value:function(e,t,n){var r=e.compareDocumentPosition(n),o=Node.DOCUMENT_POSITION_PRECEDING;if(r&o){if(null===t)return!0;var i=t.compareDocumentPosition(n),a=Node.DOCUMENT_POSITION_FOLLOWING;if(i&a)return!0}return!1}},{key:"getIteratorNode",value:function(e){var t=e.previousNode(),n=void 0;return n=null===t?e.nextNode():e.nextNode()&&e.nextNode(),{prevNode:t,node:n}}},{key:"checkIframeFilter",value:function(e,t,n,r){var o=!1,i=!1;return r.forEach(function(e,t){e.val===n&&(o=t,i=e.handled)}),this.compareNodeIframe(e,t,n)?(!1!==o||i?!1===o||i||(r[o].handled=!0):r.push({val:n,handled:!0}),!0):(!1===o&&r.push({val:n,handled:!1}),!1)}},{key:"handleOpenIframes",value:function(e,t,n,r){var o=this;e.forEach(function(e){e.handled||o.getIframeContents(e.val,function(e){o.createInstanceOnIframe(e).forEachNode(t,n,r)})})}},{key:"iterateThroughNodes",value:function(t,e,n,r,o){for(var i=this,a=this.createIterator(e,t,r),s=[],c=[],l=void 0,u=void 0,h=function(){var e=i.getIteratorNode(a);return u=e.prevNode,l=e.node};h();)this.iframes&&this.forEachIframe(e,function(e){return i.checkIframeFilter(l,u,e,s)},function(e){i.createInstanceOnIframe(e).forEachNode(t,function(e){return c.push(e)},r)}),c.push(l);c.forEach(function(e){n(e)}),this.iframes&&this.handleOpenIframes(s,t,n,r),o()}},{key:"forEachNode",value:function(n,r,o){var i=this,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:function(){},e=this.getContexts(),s=e.length;s||a(),e.forEach(function(e){var t=function(){i.iterateThroughNodes(n,e,r,o,function(){--s<=0&&a()})};i.iframes?i.waitForIframes(e,t):t()})}}],[{key:"matches",value:function(t,e){var n="string"==typeof e?[e]:e,r=t.matches||t.matchesSelector||t.msMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector;if(r){var o=!1;return n.every(function(e){return!r.call(t,e)||!(o=!0)}),o}return!1}}]),l}(),c=function(){function n(e){o(this,n),this.ctx=e,this.ie=!1;var t=window.navigator.userAgent;(-1<t.indexOf("MSIE")||-1<t.indexOf("Trident"))&&(this.ie=!0)}return i(n,[{key:"log",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"debug",n=this.opt.log;this.opt.debug&&"object"===(void 0===n?"undefined":r(n))&&"function"==typeof n[t]&&n[t]("mark.js: "+e)}},{key:"escapeStr",value:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}},{key:"createRegExp",value:function(e){return"disabled"!==this.opt.wildcards&&(e=this.setupWildcardsRegExp(e)),e=this.escapeStr(e),Object.keys(this.opt.synonyms).length&&(e=this.createSynonymsRegExp(e)),(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(e=this.setupIgnoreJoinersRegExp(e)),this.opt.diacritics&&(e=this.createDiacriticsRegExp(e)),e=this.createMergedBlanksRegExp(e),(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(e=this.createJoinersRegExp(e)),"disabled"!==this.opt.wildcards&&(e=this.createWildcardsRegExp(e)),e=this.createAccuracyRegExp(e)}},{key:"createSynonymsRegExp",value:function(e){var t=this.opt.synonyms,n=this.opt.caseSensitive?"":"i",r=this.opt.ignoreJoiners||this.opt.ignorePunctuation.length?"\0":"";for(var o in t)if(t.hasOwnProperty(o)){var i=t[o],a="disabled"!==this.opt.wildcards?this.setupWildcardsRegExp(o):this.escapeStr(o),s="disabled"!==this.opt.wildcards?this.setupWildcardsRegExp(i):this.escapeStr(i);""!==a&&""!==s&&(e=e.replace(new RegExp("("+this.escapeStr(a)+"|"+this.escapeStr(s)+")","gm"+n),r+"("+this.processSynomyms(a)+"|"+this.processSynomyms(s)+")"+r))}return e}},{key:"processSynomyms",value:function(e){return(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(e=this.setupIgnoreJoinersRegExp(e)),e}},{key:"setupWildcardsRegExp",value:function(e){return(e=e.replace(/(?:\\)*\?/g,function(e){return"\\"===e.charAt(0)?"?":""})).replace(/(?:\\)*\*/g,function(e){return"\\"===e.charAt(0)?"*":""})}},{key:"createWildcardsRegExp",value:function(e){var t="withSpaces"===this.opt.wildcards;return e.replace(/\u0001/g,t?"[\\S\\s]?":"\\S?").replace(/\u0002/g,t?"[\\S\\s]*?":"\\S*")}},{key:"setupIgnoreJoinersRegExp",value:function(e){return e.replace(/[^(|)\\]/g,function(e,t,n){var r=n.charAt(t+1);return/[(|)\\]/.test(r)||""===r?e:e+"\0"})}},{key:"createJoinersRegExp",value:function(e){var t=[],n=this.opt.ignorePunctuation;return Array.isArray(n)&&n.length&&t.push(this.escapeStr(n.join(""))),this.opt.ignoreJoiners&&t.push("\\u00ad\\u200b\\u200c\\u200d"),t.length?e.split(/\u0000+/).join("["+t.join("")+"]*"):e}},{key:"createDiacriticsRegExp",value:function(n){var r=this.opt.caseSensitive?"":"i",e=this.opt.caseSensitive?["aàáảãạăằắẳẵặâầấẩẫậäåāą","AÀÁẢÃẠĂẰẮẲẴẶÂẦẤẨẪẬÄÅĀĄ","cçćč","CÇĆČ","dđď","DĐĎ","eèéẻẽẹêềếểễệëěēę","EÈÉẺẼẸÊỀẾỂỄỆËĚĒĘ","iìíỉĩịîïī","IÌÍỈĨỊÎÏĪ","lł","LŁ","nñňń","NÑŇŃ","oòóỏõọôồốổỗộơởỡớờợöøō","OÒÓỎÕỌÔỒỐỔỖỘƠỞỠỚỜỢÖØŌ","rř","RŘ","sšśșş","SŠŚȘŞ","tťțţ","TŤȚŢ","uùúủũụưừứửữựûüůū","UÙÚỦŨỤƯỪỨỬỮỰÛÜŮŪ","yýỳỷỹỵÿ","YÝỲỶỸỴŸ","zžżź","ZŽŻŹ"]:["aàáảãạăằắẳẵặâầấẩẫậäåāąAÀÁẢÃẠĂẰẮẲẴẶÂẦẤẨẪẬÄÅĀĄ","cçćčCÇĆČ","dđďDĐĎ","eèéẻẽẹêềếểễệëěēęEÈÉẺẼẸÊỀẾỂỄỆËĚĒĘ","iìíỉĩịîïīIÌÍỈĨỊÎÏĪ","lłLŁ","nñňńNÑŇŃ","oòóỏõọôồốổỗộơởỡớờợöøōOÒÓỎÕỌÔỒỐỔỖỘƠỞỠỚỜỢÖØŌ","rřRŘ","sšśșşSŠŚȘŞ","tťțţTŤȚŢ","uùúủũụưừứửữựûüůūUÙÚỦŨỤƯỪỨỬỮỰÛÜŮŪ","yýỳỷỹỵÿYÝỲỶỸỴŸ","zžżźZŽŻŹ"],o=[];return n.split("").forEach(function(t){e.every(function(e){if(-1!==e.indexOf(t)){if(-1<o.indexOf(e))return!1;n=n.replace(new RegExp("["+e+"]","gm"+r),"["+e+"]"),o.push(e)}return!0})}),n}},{key:"createMergedBlanksRegExp",value:function(e){return e.replace(/[\s]+/gim,"[\\s]+")}},{key:"createAccuracyRegExp",value:function(e){var t=this,n=this.opt.accuracy,r="string"==typeof n?n:n.value,o="string"==typeof n?[]:n.limiters,i="";switch(o.forEach(function(e){i+="|"+t.escapeStr(e)}),r){case"partially":default:return"()("+e+")";case"complementary":return"()([^"+(i="\\s"+(i||this.escapeStr("!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~¡¿")))+"]*"+e+"[^"+i+"]*)";case"exactly":return"(^|\\s"+i+")("+e+")(?=$|\\s"+i+")"}}},{key:"getSeparatedKeywords",value:function(e){var t=this,n=[];return e.forEach(function(e){t.opt.separateWordSearch?e.split(" ").forEach(function(e){e.trim()&&-1===n.indexOf(e)&&n.push(e)}):e.trim()&&-1===n.indexOf(e)&&n.push(e)}),{keywords:n.sort(function(e,t){return t.length-e.length}),length:n.length}}},{key:"isNumeric",value:function(e){return Number(parseFloat(e))==e}},{key:"checkRanges",value:function(e){var i=this;if(!Array.isArray(e)||"[object Object]"!==Object.prototype.toString.call(e[0]))return this.log("markRanges() will only accept an array of objects"),this.opt.noMatch(e),[];var a=[],s=0;return e.sort(function(e,t){return e.start-t.start}).forEach(function(e){var t=i.callNoMatchOnInvalidRanges(e,s),n=t.start,r=t.end,o=t.valid;o&&(e.start=n,e.length=r-n,a.push(e),s=r)}),a}},{key:"callNoMatchOnInvalidRanges",value:function(e,t){var n=void 0,r=void 0,o=!1;return e&&void 0!==e.start?(n=parseInt(e.start,10),r=n+parseInt(e.length,10),this.isNumeric(e.start)&&this.isNumeric(e.length)&&0<r-t&&0<r-n?o=!0:(this.log("Ignoring invalid or overlapping range: "+JSON.stringify(e)),this.opt.noMatch(e))):(this.log("Ignoring invalid range: "+JSON.stringify(e)),this.opt.noMatch(e)),{start:n,end:r,valid:o}}},{key:"checkWhitespaceRanges",value:function(e,t,n){var r=void 0,o=!0,i=n.length,a=t-i,s=parseInt(e.start,10)-a;return r=(s=i<s?i:s)+parseInt(e.length,10),i<r&&(r=i,this.log("End range automatically set to the max value of "+i)),s<0||r-s<0||i<s||i<r?(o=!1,this.log("Invalid range: "+JSON.stringify(e)),this.opt.noMatch(e)):""===n.substring(s,r).replace(/\s+/g,"")&&(o=!1,this.log("Skipping whitespace only range: "+JSON.stringify(e)),this.opt.noMatch(e)),{start:s,end:r,valid:o}}},{key:"getTextNodes",value:function(e){var t=this,n="",r=[];this.iterator.forEachNode(NodeFilter.SHOW_TEXT,function(e){r.push({start:n.length,end:(n+=e.textContent).length,node:e})},function(e){return t.matchesExclude(e.parentNode)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},function(){e({value:n,nodes:r})})}},{key:"matchesExclude",value:function(e){return s.matches(e,this.opt.exclude.concat(["script","style","title","head","html"]))}},{key:"wrapRangeInTextNode",value:function(e,t,n){var r=this.opt.element?this.opt.element:"mark",o=e.splitText(t),i=o.splitText(n-t),a=document.createElement(r);return a.setAttribute("data-markjs","true"),this.opt.className&&a.setAttribute("class",this.opt.className),a.textContent=o.textContent,o.parentNode.replaceChild(a,o),i}},{key:"wrapRangeInMappedTextNode",value:function(s,c,l,u,h){var f=this;s.nodes.every(function(e,n){var t=s.nodes[n+1];if(void 0===t||t.start>c){if(!u(e.node))return!1;var r=c-e.start,o=(l>e.end?e.end:l)-e.start,i=s.value.substr(0,e.start),a=s.value.substr(o+e.start);if(e.node=f.wrapRangeInTextNode(e.node,r,o),s.value=i+a,s.nodes.forEach(function(e,t){n<=t&&(0<s.nodes[t].start&&t!==n&&(s.nodes[t].start-=o),s.nodes[t].end-=o)}),l-=o,h(e.node.previousSibling,e.start),!(l>e.end))return!1;c=e.end}return!0})}},{key:"wrapMatches",value:function(o,e,i,a,t){var s=this,c=0===e?0:e+1;this.getTextNodes(function(e){e.nodes.forEach(function(e){e=e.node;for(var t=void 0;null!==(t=o.exec(e.textContent))&&""!==t[c];)if(i(t[c],e)){var n=t.index;if(0!==c)for(var r=1;r<c;r++)n+=t[r].length;e=s.wrapRangeInTextNode(e,n,n+t[c].length),a(e.previousSibling),o.lastIndex=0}}),t()})}},{key:"wrapMatchesAcrossElements",value:function(i,e,a,s,c){var l=this,u=0===e?0:e+1;this.getTextNodes(function(e){for(var t=void 0;null!==(t=i.exec(e.value))&&""!==t[u];){var n=t.index;if(0!==u)for(var r=1;r<u;r++)n+=t[r].length;var o=n+t[u].length;l.wrapRangeInMappedTextNode(e,n,o,function(e){return a(t[u],e)},function(e,t){i.lastIndex=t,s(e)})}c()})}},{key:"wrapRangeFromIndex",value:function(e,c,l,t){var u=this;this.getTextNodes(function(a){var s=a.value.length;e.forEach(function(t,n){var e=u.checkWhitespaceRanges(t,s,a.value),r=e.start,o=e.end,i=e.valid;i&&u.wrapRangeInMappedTextNode(a,r,o,function(e){return c(e,t,a.value.substring(r,o),n)},function(e){l(e,t)})}),t()})}},{key:"unwrapMatches",value:function(e){for(var t=e.parentNode,n=document.createDocumentFragment();e.firstChild;)n.appendChild(e.removeChild(e.firstChild));t.replaceChild(n,e),this.ie?this.normalizeTextNode(t):t.normalize()}},{key:"normalizeTextNode",value:function(e){if(e){if(3===e.nodeType)for(;e.nextSibling&&3===e.nextSibling.nodeType;)e.nodeValue+=e.nextSibling.nodeValue,e.parentNode.removeChild(e.nextSibling);else this.normalizeTextNode(e.firstChild);this.normalizeTextNode(e.nextSibling)}}},{key:"markRegExp",value:function(e,t){var n=this;this.opt=t,this.log('Searching with expression "'+e+'"');var r=0,o="wrapMatches";this.opt.acrossElements&&(o="wrapMatchesAcrossElements"),this[o](e,this.opt.ignoreGroups,function(e,t){return n.opt.filter(t,e,r)},function(e){r++,n.opt.each(e)},function(){0===r&&n.opt.noMatch(e),n.opt.done(r)})}},{key:"mark",value:function(e,t){var o=this;this.opt=t;var i=0,a="wrapMatches",n=this.getSeparatedKeywords("string"==typeof e?[e]:e),s=n.keywords,c=n.length,l=this.opt.caseSensitive?"":"i";this.opt.acrossElements&&(a="wrapMatchesAcrossElements"),0===c?this.opt.done(i):function e(n){var t=new RegExp(o.createRegExp(n),"gm"+l),r=0;o.log('Searching with expression "'+t+'"'),o[a](t,1,function(e,t){return o.opt.filter(t,n,i,r)},function(e){r++,i++,o.opt.each(e)},function(){0===r&&o.opt.noMatch(n),s[c-1]===n?o.opt.done(i):e(s[s.indexOf(n)+1])})}(s[0])}},{key:"markRanges",value:function(e,t){var o=this;this.opt=t;var n=0,r=this.checkRanges(e);r&&r.length?(this.log("Starting to mark with the following ranges: "+JSON.stringify(r)),this.wrapRangeFromIndex(r,function(e,t,n,r){return o.opt.filter(e,t,n,r)},function(e,t){n++,o.opt.each(e,t)},function(){o.opt.done(n)})):this.opt.done(n)}},{key:"unmark",value:function(e){var r=this;this.opt=e;var o=this.opt.element?this.opt.element:"*";o+="[data-markjs]",this.opt.className&&(o+="."+this.opt.className),this.log('Removal selector "'+o+'"'),this.iterator.forEachNode(NodeFilter.SHOW_ELEMENT,function(e){r.unwrapMatches(e)},function(e){var t=s.matches(e,o),n=r.matchesExclude(e);return!t||n?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},this.opt.done)}},{key:"opt",set:function(e){this._opt=a({},{element:"",className:"",exclude:[],iframes:!1,iframesTimeout:5e3,separateWordSearch:!0,diacritics:!0,synonyms:{},accuracy:"partially",acrossElements:!1,caseSensitive:!1,ignoreJoiners:!1,ignoreGroups:0,ignorePunctuation:[],wildcards:"disabled",each:function(){},noMatch:function(){},filter:function(){return!0},done:function(){},debug:!1,log:window.console},e)},get:function(){return this._opt}},{key:"iterator",get:function(){return new s(this.ctx,this.opt.iframes,this.opt.exclude,this.opt.iframesTimeout)}}]),n}(),function(e){var n=this,r=new c(e);return this.mark=function(e,t){return r.mark(e,t),n},this.markRegExp=function(e,t){return r.markRegExp(e,t),n},this.markRanges=function(e,t){return r.markRanges(e,t),n},this.unmark=function(e){return r.unmark(e),n},this})});function D(e){window.dispatchEvent(new CustomEvent("bookmark-visibility-change",{detail:e}))}function G(e){return{data:e.data,tag:e.parentElement.tagName,html:e.parentElement.innerHTML}}function $(e){var t=null,n=!0,r=!1,o=void 0;try{for(var i,a=document.querySelectorAll(e.tag)[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;if(s.innerHTML===e.html){t=s;break}}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}if(t){var c=null,l=!0,u=!1,h=void 0;try{for(var f,d=t.childNodes[Symbol.iterator]();!(l=(f=d.next()).done);l=!0){var p=f.value;if(p.data===e.data){c=p;break}}}catch(e){u=!0,h=e}finally{try{l||null==d.return||d.return()}finally{if(u)throw h}}return c}j("Sorry, we couldn't find this bookmark")}function Y(e){e.offset.startNode=$(e.offset.startNode),e.offset.endNode=$(e.offset.endNode)}function K(e){var t=function(e){if(!e.rangeCount)return j("No text selected");Z();var t=e.getRangeAt(0),n={text:t.toString().trim(),startContainer:t.startContainer,startOffset:t.startOffset,endContainer:t.endContainer,endOffset:t.endOffset},r=G(n.startContainer),o=G(n.endContainer);return{time:Date.now(),text:n.text,offset:{start:n.startOffset,end:n.endOffset,startNode:r,endNode:o}}}(e),n=ne();n.push(t),re(n),j("Bookmark saved",{label:"View",action:function(){Q(t)}})}var U=document.createElement("mark");function X(e,t){var n=U.cloneNode();n.dataset.id=t,e.parentNode.insertBefore(n,e),n.appendChild(e)}function Z(){D(!1),window.is_highlighting_bookmarks=!1;var e=document.querySelectorAll(".bookmark-highlight"),t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value,s=a.parentNode;a.replaceWith.apply(a,_toConsumableArray(a.childNodes)),s.normalize()}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}function Q(e){Y(e=JSON.parse(JSON.stringify(e))),D(!0),window.is_highlighting_bookmarks=!0,window.getSelection().removeAllRanges();var t=document.createRange();console.log("restored bookmark",e),t.setStart(e.offset.startNode,e.offset.start),t.setEnd(e.offset.endNode,e.offset.end);var n=t.commonAncestorContainer;1!=n.nodeType&&(n=n.parentElement),function(e,t,n){if(t.startContainer===t.endContainer){var r=t.startContainer.splitText(t.startOffset);return r.splitText(t.endOffset),X(r,n)}for(var o=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:function(e){return function(e,t){return t.intersectsNode?t.intersectsNode(e):function(e,t){return-1===t.compareBoundaryPoints(t.END_TO_START,e)&&1===t.compareBoundaryPoints(t.START_TO_END,e)}(function(t){var n=t.ownerDocument.createRange();try{n.selectNode(t)}catch(e){n.selectNodeContents(t)}return n}(e),t)}(e,t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},!1);o.nextNode();){var i=o.currentNode;i===t.startContainer?i=i.splitText(t.startOffset):i===t.endContainer&&i.splitText(t.endOffset),X(i,n)}}(n,t,e.time)}function ee(){return window.is_highlighting_bookmarks?Z():function(){throw new Error("FIXME: Cannot show all bookmarks without risk of overlap.")}(),window.is_highlighting_bookmarks}function te(){return ne().length}function ne(){return JSON.parse(localStorage.getItem("bookmarks")||"[]")}function re(e){localStorage.setItem("bookmarks",JSON.stringify(e)),function(e){window.dispatchEvent(new CustomEvent("bookmark-update",{detail:e}))}()}U.classList.add("bookmark-highlight");var oe=String.raw,ie=function(e){function t(){var n;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).hasBookmarks=te(),window.addEventListener("bookmark-update",function(){n.hasBookmarks=te()}),window.addEventListener("bookmark-visibility-change",function(e){var t=e.detail;console.log("udpate;"),n.bookmarksVisible=t}),n.innerHTML=oe(_templateObject2()),n.marker=new V(document.querySelector("us-constitution main")),n.toggle=n.toggle.bind(_assertThisInitialized(n)),n.search=n.search.bind(_assertThisInitialized(n)),n.handleClick=n.handleClick.bind(_assertThisInitialized(n)),n.detectSelection=n.detectSelection.bind(_assertThisInitialized(n)),n.blurSearchIfFocused=n.blurSearchIfFocused.bind(_assertThisInitialized(n)),n}return _inherits(t,_wrapNativeSuper(HTMLElement)),_createClass(t,[{key:"searchBar",get:function(){return this.querySelector("input")}},{key:"searching",get:function(){return this.classList.contains("searching")},set:function(e){e?(Z(),document.body.classList.remove("bookmarks-drawer-active"),this.classList.add("searching"),this.searchBar.focus(),document.addEventListener("touchstart",this.blurSearchIfFocused),this.search()):(this.classList.remove("searching"),this.searchBar.blur(),document.removeEventListener("touchstart",this.blurSearchIfFocused),this.dispatchEvent(new CustomEvent("search-closed")))}},{key:"bookmarksVisible",set:function(e){e?this.classList.add("bookmarks-visible"):this.classList.remove("bookmarks-visible")}},{key:"hasBookmarks",set:function(e){e?this.classList.add("has-bookmarks"):this.classList.remove("has-bookmarks")}},{key:"selecting",get:function(){return this.classList.contains("selecting")},set:function(e){e?this.classList.add("selecting"):this.classList.remove("selecting")}},{key:"totalFoundFromSearch",set:function(e){this.querySelector("#searchTotalNumber").textContent=e,this.currentFoundFromSearch=1},get:function(){return parseInt(this.querySelector("#searchTotalNumber").textContent,10)}},{key:"currentFoundFromSearch",set:function(e){if(0===this.totalFoundFromSearch)e=0;else if(e<1||e>this.totalFoundFromSearch)return;this.querySelector("#searchCurrentNumber").textContent=e;var t=!0,n=!1,r=void 0;try{for(var o,i=document.querySelectorAll("mark.search.active")[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){o.value.classList.remove("active")}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}console.log('document.querySelectorAll("mark.search") :',document.querySelectorAll("mark.search").length);var a=document.querySelectorAll("mark.search")[e-1];a&&(a.classList.add("active"),H(a))},get:function(){return parseInt(this.querySelector("#searchCurrentNumber").textContent,10)}}]),_createClass(t,[{key:"connectedCallback",value:function(){var t=this;this.querySelector("button[title=Search]").addEventListener("click",this.toggle),this.searchBar.addEventListener("input",this.search),this.addEventListener("search-update",function(e){return t.totalFoundFromSearch=e.detail}),this.addEventListener("search-closed",function(){return t.clearHighlight()}),this.addEventListener("click",this.handleClick);var e=this.querySelector("#saveBookmark");e.addEventListener("mousedown",function(){return t.saveBookmark()}),e.addEventListener("touchstart",function(){return t.saveBookmark()}),document.addEventListener("mouseup",this.detectSelection),document.addEventListener("touchstart",function(e){return e.preventDefault()}),document.addEventListener("touchmove",function(e){return e.preventDefault()}),document.addEventListener("touchcancel",this.detectSelection),document.addEventListener("touchend",this.detectSelection),document.addEventListener("keyup",this.detectSelection)}},{key:"blurSearchIfFocused",value:function(e){e.target!==this.searchBar&&this.searchBar.blur()}},{key:"detectSelection",value:function(){var e=window.getSelection();if(e.rangeCount&&""!==e.toString().trim()){var t=e.getRangeAt(0),n=1===t.startContainer.nodeType?t.startContainer:t.startContainer.parentElement,r=1===t.endContainer.nodeType?t.endContainer:t.endContainer.parentElement;(n.closest("article")||n.closest("#declarationOfIndependence")||n.closest(".amendments"))&&(r.closest("article")||r.closest("#declarationOfIndependence")||r.closest(".amendments"))?(this.selecting=!0,this.lastSelection=e,localStorage.getItem("bookmark_toast")||(localStorage.setItem("bookmark_toast",!0),j("Tip: click the star to save a bookmark"))):this.selecting=!1}else this.selecting=!1}},{key:"saveBookmark",value:function(){this.selecting&&(K(this.lastSelection),this.lastSelection.empty(),this.selecting=!1)}},{key:"toggleBookmarkHighlighting",value:function(){this.bookmarksVisible=ee()}},{key:"handleClick",value:function(e){e.target.closest("#searchForward")?this.currentFoundFromSearch++:e.target.closest("#searchBackward")?this.currentFoundFromSearch--:e.target.closest("#toggleBookmarks")?this.toggleBookmarkHighlighting():e.target.closest("#viewBookmarks")?document.body.classList.toggle("bookmarks-drawer-active"):e.target.closest("#toggleNav")&&document.body.classList.toggle("nav-open")}},{key:"toggle",value:function(e){this.searching=!this.searching}},{key:"highlight",value:function(e){var t=this;this.marker.mark(e,{acrossElements:!0,separateWordSearch:!1,className:"search",exclude:["h1.usc"],done:function(e){t.dispatchEvent(new CustomEvent("search-update",{detail:e}))}})}},{key:"clearHighlight",value:function(){var t=this;return new Promise(function(e){t.marker.unmark({className:"search",done:function(){e()}}),t.searchBar.value.length<2&&(t.totalFoundFromSearch=0)})}},{key:"search",value:function(){var t=this;this.searching&&(this._searchTimeout&&clearTimeout(this._searchTimeout),this._searchTimeout=setTimeout(_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.clearHighlight();case 2:if(t.searchBar.value.length<2)return e.abrupt("return");e.next=4;break;case 4:requestIdleCallback(function(){t.highlight(t.searchBar.value.trim())});case 5:case"end":return e.stop()}},e)})),100))}}]),t}();customElements.get("us-header")||customElements.define("us-header",ie);var ae=document.createElement("div");function se(){ae.classList.add("visible")}function ce(){return ae.classList.contains("visible")?new Promise(function(e){ae.addEventListener("transitionend",function(){ae.textContent="",e()},{once:!0}),ae.classList.remove("visible"),document.querySelectorAll(".dfn-highlighted").forEach(function(e){return e.classList.remove("dfn-highlighted")})}):Promise.resolve()}function le(){return(le=_asyncToGenerator(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(ae.textContent===t)return e.next=3,ce();e.next=4;break;case 3:return e.abrupt("return",!1);case 4:return e.next=6,ce();case 6:return ae.textContent=t,se(),e.abrupt("return",!0);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}ae.classList.add("dfn-panel"),document.body.appendChild(ae),document.addEventListener("click",function(e){ce()});var ue={setText:function(e){return le.apply(this,arguments)},hide:ce,show:se};document.addEventListener("click",function(e){if("function"==typeof e.target.closest){var t=e.target.closest("us-dfn");t&&t.show()}});var he=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))}var n;return _inherits(t,_wrapNativeSuper(HTMLElement)),_createClass(t,[{key:"connectedCallback",value:function(){if(!this.explanation)return console.warn("Untitiled dfn",this)}},{key:"show",value:(n=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue.setText(this.explanation);case 2:t=e.sent,document.querySelectorAll(".dfn-highlighted").forEach(function(e){return e.classList.remove("dfn-highlighted")}),t&&this.classList.add("dfn-highlighted");case 5:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"explanation",get:function(){return this.dataset.explanation}}]),t}();customElements.get("us-dfn")||customElements.define("us-dfn",he);var fe=String.raw,de=function(e){function n(e){var t;return _classCallCheck(this,n),(t=_possibleConstructorReturn(this,_getPrototypeOf(n).call(this))).bookmark=e,t.innerHTML=fe(_templateObject3(),t.truncate(t.bookmark.text)),t}return _inherits(n,_wrapNativeSuper(HTMLElement)),_createClass(n,[{key:"truncate",value:function(e){return e.length<50?e:"".concat(e.substr(0,50),"...")}},{key:"delete",value:function(){var t=this;Z(),re(ne().filter(function(e){return e.time!==t.bookmark.time}))}},{key:"scrollToHighlight",value:function(){Z(),window.is_highlighting_bookmarks||Q(this.bookmark);var e=document.querySelector('mark.bookmark-highlight[data-id="'.concat(this.bookmark.time,'"]'));document.body.classList.contains("bookmarks-drawer-active")&&document.body.classList.remove("bookmarks-drawer-active"),e?H(e):j("Can't scroll to bookmark")}}]),n}();customElements.get("bookmark-preview")||customElements.define("bookmark-preview",de);var pe=function(e){function n(){var t;return _classCallCheck(this,n),(t=_possibleConstructorReturn(this,_getPrototypeOf(n).call(this))).handleClick=t.handleClick.bind(_assertThisInitialized(t)),t.buildBookmarksList(),window.addEventListener("storage",function(e){"bookmark"===e.key&&t.buildBookmarksList()}),t.addEventListener("click",t.handleClick),window.addEventListener("bookmark-update",function(){return t.buildBookmarksList()}),t}return _inherits(n,_wrapNativeSuper(HTMLElement)),_createClass(n,[{key:"destoryBookmarksList",value:function(){this.querySelectorAll("bookmark-preview, p.no-bookmarks").forEach(function(e){return e.remove()})}},{key:"buildBookmarksList",value:function(){console.log("building list"),this.destoryBookmarksList();var e=ne();if(!e.length){this.classList.remove("editing");var t=document.createElement("p");return t.classList.add("no-bookmarks"),t.innerHTML="No Bookmarks.<br>Select some text to add one.",void this.appendChild(t)}var n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;this.add(s)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}},{key:"add",value:function(e){var t=new de(e);this.appendChild(t)}},{key:"handleClick",value:function(e){if(!e.target.closest("#bookmarkEdit"))return document.body.classList.remove("bookmarks-drawer-active"),e.target.closest("bookmark-preview")?this.handlePreviewClick(e):void 0;this.classList.toggle("editing")}},{key:"handlePreviewClick",value:function(e){var t=e.target.closest("bookmark-preview");this.classList.contains("editing")?(t.delete(),this.classList.remove("editing")):t.scrollToHighlight()}}]),n}();customElements.get("bookmark-manager")||customElements.define("bookmark-manager",pe),z("/",function(){window.scrollTo({top:0,behavior:"smooth"})}),z("/preamble",function(){H(document.querySelector("#preamble"))}),z("/declaration-of-independence",function(){H(document.querySelector("#declarationOfIndependence"))}),z("/bill-of-rights",function(){H(document.querySelector("#billOfRights"))}),z("/articles-of-confederation",function(){H(document.querySelector("#oldPreamble"))}),z("/about",function(){H(document.querySelector("#about"))}),z("/article/*",function(e){H(document.querySelector("#article".concat(e)))}),z("/article/*/*",function(e,t){var n=document.querySelector("#article".concat(e));n&&H(n.closest("article").querySelectorAll(".section-marker")[parseInt(t,10)-1])}),z("/amendment/*",function(e){H(document.querySelector("#amendment".concat(e)))}),z("/confederation/*",function(e){H(document.querySelector("#oldArticle".concat(e)))}),document.querySelector("aside").addEventListener("click",function(e){document.body.classList.remove("nav-open"),z.exec()}),"serviceWorker"in navigator&&navigator.serviceWorker.register("/foundingdocuments/service-worker.js").then(function(){localStorage.getItem("offline-prompt")||(j("Available offline",{label:"Ok"},1e4),localStorage.setItem("offline-prompt",!0))}).catch(function(e){console.log("Service worker registration failed: "+e)}),z.base("/foundingdocuments/"),z.start(!0)}();
//# sourceMappingURL=/js/maps/index.js.map
